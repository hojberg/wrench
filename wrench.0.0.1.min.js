(function(){var j={},c={routes:{}},f=window,k=document;j.VERSION="0.0.1";c.lastRoute="/";c.changeRoute=function(a,b){var d=a,e=1;if(typeof b!=="undefined"){d+="?";for(var h in b)if(b.hasOwnProperty(h)){if(e!==1)d+="&";d+=h+"="+b[h];e++}}a=f.location.hash!==""&&f.location.hash!=="#"&&f.location.hash.indexOf(a)===-1?f.location.hash+";"+d:d;c.lastRoute=f.location.hash;f.location.hash=a};c.hasChanged=function(){var a=f.location.hash!=c.lastRoute&&f.location.hash!="#"+c.lastRoute;c.lastRoute=f.location.hash;
return a};c.locate=function(){if(c.hasChanged()){var a=f.location.hash.replace("#","").split(";"),b=a.length,d={},e="";if(b>0&&a[0]!=="")for(var h=0;h<b;h++){var g=a[h].split("?");e=g.shift();if(g.length>0&&typeof g[0]!=="undefined"){g=g[0].split("&");for(var l=g.length,i=0;i<l;i++)d[g[i].split("=")[0]]=g[i].split("=")[1]}e in c.routes&&c.routes[e](d)}else"/"in c.routes&&c.routes["/"]()}};c.attachFormRoutes=function(){for(var a=0;a<k.forms.length;a++){var b=k.forms[a],d={};if(b.action.indexOf("#")==
0)b.onsubmit=function(){for(var e=0;e<b.elements.length;e++)d[b.elements[e].id]=b.elements[e].value;c.changeRoute(b.action.replace("#",""),d);return false}}};var m={run:function(a){var b=this,d=function(){c.locate();c.attachFormRoutes();typeof b.init==="function"&&b.init()};f.addEventListener("load",d,false);if("onhashchange"in f)f.onhashchange=c.locate;else setInterval(c.locate,500);a&&d();return b}};j.appify=function(a){function b(){}b.prototype=m;var d=new b;for(var e in a)if(a.hasOwnProperty(e))d[e]=
a[e];return d};f.route=function(a,b){if(typeof b==="function"){c.routes[a]=b;return function(d){c.changeRoute(a,d);b(d)}}else return{to:function(d){c.routes[a]=d;return function(e){c.changeRoute(a,e);d(e)}}}};f.wrench=j})();